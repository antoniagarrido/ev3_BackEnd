{% extends 'base.html' %}

{% block content %}
<div class="card">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
    <h1>Productos de la Tienda</h1>
    {% if user.is_staff %}
    <a href="{% url 'producto_create' %}" class="btn btn-primary">Agregar Producto</a>
    {% endif %}
  </div>

  <form method="get" class="search-form">
    <input type="text" name="q" value="{{ q|default:'' }}" placeholder="Buscar producto...">
    <button type="submit" class="btn">Buscar</button>
  </form>

  <div class="product-grid">
    {% for producto in page_obj %}
      <div class="product-card">
        
        <div class="product-image-container">
          {% if producto.imagen %}
            <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}" class="product-image">
          {% else %}
            <div class="product-image-placeholder"></div>
          {% endif %}
        </div>
        
        <div class="product-info">
          <h3 class="product-name">{{ producto.nombre }}</h3>
          <p class="product-price">${{ producto.precio }}</p>
          <p class="product-stock">Stock: {{ producto.stock }}</p>
          
          {% if user.is_staff %}
          <div class="product-actions">
            <a href="{% url 'producto_edit' producto.pk %}" class="btn">Editar</a>
            <a href="{% url 'producto_delete' producto.pk %}" class="btn">Eliminar</a>
          </div>
          {% endif %}
        </div>
        
      </div>
    {% empty %}
      <p style="grid-column: 1 / -1;">No hay productos registrados.</p>
    {% endfor %}
  </div>
  
  {% include 'paginator.html' %}
</div>
{% endblock %}